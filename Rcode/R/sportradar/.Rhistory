players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% arrange(index)
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
)
View(players_1)
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
) %>% na.omit()
View(players_1)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- players_2 %>% arrange(index)
players_2 <- players_2 %>% mutate(
opponent = players_1$NextFixture1
) %>% na.omit()
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% arrange(index)
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
) %>% na.omit()
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- players_2 %>% arrange(index)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound)
players_2 <- players_2 %>% mutate(
opponent = players_1$NextFixture1
) %>% na.omit()
#############################
# How to handle players not represented: Give them a 0 score AFTER regression is performed
#############################
###########################
#Check how well index matcing works
###########################
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% arrange(index)
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
) %>% na.omit()
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- players_2 %>% arrange(index)
players_2 <- players_2 %>% mutate(
opponent = players_1$NextFixture1
) %>% na.omit()
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% arrange(index)
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
) %>% na.omit()
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% arrange(index)
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- players_2 %>% arrange(index)
players_2 <- players_2 %>% mutate(
opponent = players_1$NextFixture1
)
players_1 <- players_1 %>% na.omit()
players_2 <- players_2 %>% na.omit()
View(players_1)
View(players_2)
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% arrange(index)
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- players_2 %>% arrange(index)
players_2 <- players_2 %>% mutate(
opponent = players_1$NextFixture1
)
players_1 <- players_1 %>% na.omit()
players_2 <- players_2 %>% na.omit()
View(players)
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
View(players_0)
View(players)
#############################
# How to handle players not represented: Give them a 0 score AFTER regression is performed
#############################
###########################
#Check how well index matcing works
###########################
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
)  %>% select(index,Team,PositionsList,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- players_2 %>% mutate(
opponent = players_1$NextFixture1
)  %>% select(index,Team,PositionsList,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- players_1 %>% na.omit()
players_2 <- players_2 %>% na.omit()
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
View(players_1)
View(players)
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
)
#last filtering
players_1 <- players_1 %>% select(
index,Team,PositionsList,Cost,PointsLastRound,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
#############################
# How to handle players not represented: Give them a 0 score AFTER regression is performed
#############################
###########################
#Check how well index matcing works
###########################
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost, PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- players_2 %>% arrange(index)
players_2 <- players_2 %>% mutate(
opponent = players_1$NextFixture1
)
#last filtering
players_1 <- players_1 %>% select(
index,Team,PositionsList,Cost,PointsLastRound,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
players_2 <- players_2 %>% na.omit()
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% mutate(
opponent = players_0$NextFixture1
)
View(players_1)
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% arrange(index)
View(players_0)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
View(players_1)
players_1 <- full_join(players_1,players_0,by = "index")
View(players_1)
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% select(index,NextFixture1)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(opponent = NextFixture1)
View(players_1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% select(index,NextFixture1)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(opponent = NextFixture1) select(
index,Team,PositionsList,Cost,PointsLastRound,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
players_1 <- players_1 %>% mutate(opponent = NextFixture1) select(index,Team,PositionsList,Cost,PointsLastRound,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
players_1 <- players_1 %>% mutate(opponent = NextFixture1) %>% select(index,Team,PositionsList,Cost,PointsLastRound,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
players_1 <- players_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(index,Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(index,Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% select(index,NextFixture1)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(index,Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
View(players_1)
model <- lm(points ~ ., data = players_1)
summary(model)
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% select(index,NextFixture1)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound,
index_char = as.character(index)
) %>% select(index,Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
options(stringsAsFactors = T)
model <- lm(points ~ ., data = players_1)
summary(model)
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% select(index,NextFixture1)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
options(stringsAsFactors = T)
model <- lm(points ~ ., data = players_1)
summary(model)
#2
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% select(index,NextFixture1)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- full_join(players_2,players_0,by = "index")
players_2 <- players_2 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- players_1 %>% select(index,NextFixture1)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- full_join(players_2,players_1,by = "index")
players_2 <- players_2 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
predictions <- predict(object = model,newdata = players_2)
predictions
model <- lm(points ~ ., data = players_1)
summary(model)
View(players_1)
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% select(index,NextFixture1)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
View(players_1)
#############################
# How to handle players not represented: Give them a 0 score AFTER regression is performed
#############################
###########################
#Check how well index matcing works
###########################
#1
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% select(index,NextFixture1)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
#2
players_1_2 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_1_2 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1_2 <- players_1 %>% select(index,NextFixture1)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- full_join(players_2,players_1_2,by = "index")
players_2 <- players_2 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
#1
players_0 <- data_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_0 <- full_join(players_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_0 <- players_0 %>% select(index,NextFixture1)
players_1 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_1 <- full_join(players_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1 <- full_join(players_1,players_0,by = "index")
players_1 <- players_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
players_1_2 <- data_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_1_2 <- full_join(players_1_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_1_2 <- players_1 %>% select(index,NextFixture1)
players_1_2 <- players_1_2 %>% select(index,NextFixture1)
players_2 <- data_2 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_2 <- full_join(players_2,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_2 <- full_join(players_2,players_1_2,by = "index")
players_2 <- players_2 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
data_3 <- cbind(players_1,players_2)
data_3 <- rbind(players_1,players_2)
View(data_3)
####################
# Fit round by round for 1 and 2
###################
options(stringsAsFactors = T)
data_3 <- rbind(players_1,players_2)
model <- lm(points ~ ., data = players_1)
summary(model)
model <- lm(points ~ ., data = data_3)
summary(model)
