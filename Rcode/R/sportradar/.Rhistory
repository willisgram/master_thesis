Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,PointsLastRound) %>% arrange(index)
points_round_16 <- cbind(points_round_16,data_temp$PointsLastRound)
colnames(points_round_16)[i-3] <- paste0("round_",i)
}
#Opponents
opponent_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,NextFixture1) %>% arrange(index)
opponent_round_16 <- cbind(opponent_round_16,data_temp$NextFixture1)
colnames(opponent_round_16)[i-3] <- paste0("round_",i+1)
}
#Cost
cost_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,Cost) %>% arrange(index)
cost_round_16 <- cbind(cost_round_16,data_temp$Cost)
colnames(cost_round_16)[i-3] <- paste0("round_",i)
}
#Team
team_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,Team.x) %>% arrange(index)
team_round_16 <- cbind(team_round_16,data_temp$Team.x)
colnames(team_round_16)[i-3] <- paste0("round_",i)
}
#Position
pos_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,PositionsList.x) %>% arrange(index)
pos_round_16 <- cbind(pos_round_16,data_temp$PositionsList.x)
colnames(pos_round_16)[i-3] <- paste0("round_",i)
}
#Transfers in
trans_in_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,TransfersInRound) %>% arrange(index)
trans_in_round_16 <- cbind(trans_in_round_16,data_temp$TransfersInRound)
colnames(trans_in_round_16)[i-3] <- paste0("round_",i)
}
#Transfers out
trans_out_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,TransfersOutRound) %>% arrange(index)
trans_out_round_16 <- cbind(trans_out_round_16,data_temp$TransfersOutRound)
colnames(trans_out_round_16)[i-3] <- paste0("round_",i)
}
rm(list = c("data_26","data_temp"))
######################
# Distribute points from k matches
######################
k <- 3
upper_lim <- 34-(k-1)
#points
for (i in seq(from = 2,by = k, to = upper_lim)) {
points_round_temp <- data.frame(index = 1:625)
points_round_temp[,2:(k+1)] <- points_round_16[,i:(i+(k-1))]
colnames(points_round_temp)[2:(k)] <- paste0("prev_",(k-1):1)
colnames(points_round_temp)[(k+1)] <- "realized"
if(i == 2){
points_round_k_16 <- points_round_temp
} else{
points_round_k_16 <- rbind(points_round_k_16,points_round_temp)
}
}
#Opponents
for (i in seq(from = 2,by = k, to = upper_lim)) {
opponent_round_temp <- data.frame(index = 1:625)
opponent_round_temp[,2] <- opponent_round_16[,(i)]
colnames(opponent_round_temp)[2] <- "opponent"
if(i == 2){
opponent_round_k_16 <- opponent_round_temp
} else{
opponent_round_k_16    <- rbind(opponent_round_k_16,opponent_round_temp)
}
}
opponent_round_k_16 <- opponent_round_k_16 %>% select(opponent)
#Team
for (i in seq(from = 2,by = k, to = upper_lim)) {
team_round_temp <- data.frame(index = 1:625)
team_round_temp[,2] <- team_round_16[,(i)]
colnames(team_round_temp)[2] <- "team"
if(i == 2){
team_round_k_16 <- team_round_temp
} else{
team_round_k_16    <- rbind(team_round_k_16,team_round_temp)
}
}
team_round_k_16 <- team_round_k_16 %>% select(team)
#Cost
for (i in seq(from = 2,by = k, to = upper_lim)) {
cost_round_temp <- data.frame(index = 1:625)
cost_round_temp[,2] <- cost_round_16[,(i)]
colnames(cost_round_temp)[2] <- "cost"
if(i == 2){
cost_round_k_16 <- cost_round_temp
} else{
cost_round_k_16    <- rbind(cost_round_k_16,cost_round_temp)
}
}
cost_round_k_16 <- cost_round_k_16 %>% select(cost)
#Pos
for (i in seq(from = 2,by = k, to = upper_lim)) {
pos_round_temp <- data.frame(index = 1:625)
pos_round_temp[,2] <- pos_round_16[,(i)]
colnames(pos_round_temp)[2] <- "pos"
if(i == 2){
pos_round_k_16 <- pos_round_temp
} else{
pos_round_k_16    <- rbind(pos_round_k_16,pos_round_temp)
}
}
pos_round_k_16 <- pos_round_k_16 %>% select(pos)
#Transfers in
for (i in seq(from = 2,by = k, to = upper_lim)) {
trans_in_round_temp <- data.frame(index = 1:625)
trans_in_round_temp[,2:(k+1)] <- trans_in_round_16[,i:(i+(k-1))]
colnames(trans_in_round_temp)[2:(k)] <- paste0("trans_in_prev_",(k-1):1)
colnames(trans_in_round_temp)[(k+1)] <- "realized"
if(i == 2){
trans_in_round_k_16 <- trans_in_round_temp
} else{
trans_in_round_k_16    <- rbind(trans_in_round_k_16,trans_in_round_temp)
}
}
trans_in_round_k_16 <- trans_in_round_k_16 %>% select(trans_in_prev_2,trans_in_prev_1)
#Transfers out
for (i in seq(from = 2,by = k, to = upper_lim)) {
trans_out_round_temp <- data.frame(index = 1:625)
trans_out_round_temp[,2:(k+1)] <- trans_out_round_16[,i:(i+(k-1))]
colnames(trans_out_round_temp)[2:(k)] <- paste0("trans_out_prev_",(k-1):1)
colnames(trans_out_round_temp)[(k+1)] <- "realized"
if(i == 2){
trans_out_round_k_16 <- trans_out_round_temp
} else{
trans_out_round_k_16    <- rbind(trans_out_round_k_16,trans_out_round_temp)
}
}
trans_out_round_k_16 <- trans_out_round_k_16 %>% select(trans_out_prev_2,trans_out_prev_1)
regressors_16 <- cbind(points_round_k_16,opponent_round_k_16,team_round_k_16,pos_round_k_16,trans_in_round_k_16,trans_out_round_k_16)
regressors_16$index <- as.factor(regressors_16$index)
regressors_train_16 <- regressors_16[1:6250,] %>% na.omit()
regressors_test_data_16  <- regressors_16[6251:6875,] %>% na.omit()
regressors_test_data_16  <- regressors_test_data_16 %>% filter(index %in% regressors_train_16$index)
regressors_test_16  <- regressors_test_data_16[,names(regressors_test_data_16) != "realized"]
options(stringsAsFactors = T)
model_3 <- lm(realized ~ index + prev_2 + prev_1 + opponent + team + pos + trans_in_prev_2 +
trans_in_prev_2 + trans_out_prev_1 + trans_out_prev_2,
data = regressors_train)
model_3 <- lm(realized ~ index + prev_2 + prev_1 + opponent + team + pos + trans_in_prev_2 +
trans_in_prev_2 + trans_out_prev_1 + trans_out_prev_2,
data = regressors_train_16)
summary(model_3)
predictions <- predict(object = model_3,newdata = regressors_test_16)
compare <- data.frame(pred = predictions, real = regressors_test_data_16$realized )
View(compare)
######################
# Full 2017 data import
######################
#Points
###########
#Import training data
library(tidyverse)
options(stringsAsFactors = F)
folder <- "input/"
points_round_17 <- data.frame(index = 1:625)
for( i in 1:27){
year     <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,PointsLastRound) %>% arrange(index)
points_round_17 <- cbind(points_round_17,data_temp$PointsLastRound)
colnames(points_round_17)[i+1] <- paste0("round_",i)
}
#Opponents
opponent_round_17 <- data.frame(index = 1:625)
for( i in 0:28){
year     <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,NextFixture1) %>% arrange(index)
opponent_round_17 <- cbind(opponent_round_17,data_temp$NextFixture1)
colnames(opponent_round_17)[i+2] <- paste0("round_",i+1)
}
#Cost
cost_round_17 <- data.frame(index = 1:625)
for( i in 0:28){
year     <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,Cost) %>% arrange(index)
cost_round_17 <- cbind(cost_round_17,data_temp$Cost)
colnames(cost_round_17)[i+2] <- paste0("round_",i+1)
}
#Team
team_round_17 <- data.frame(index = 1:625)
for( i in 0:28){
year     <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,Team.x) %>% arrange(index)
team_round_17 <- cbind(team_round_17,data_temp$Team.x)
colnames(team_round_17)[i+1] <- paste0("round_",i)
}
#Position
pos_round_17 <- data.frame(index = 1:625)
for( i in 0:28){
year     <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,PositionsList.x) %>% arrange(index)
pos_round_17 <- cbind(pos_round_17,data_temp$PositionsList.x)
colnames(pos_round_17)[i+2] <- paste0("round_",i+1)
}
#Transfers in
trans_in_round_17 <- data.frame(index = 1:625)
for( i in 1:28){
year     <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,TransfersInRound) %>% arrange(index)
trans_in_round_17 <- cbind(trans_in_round_17,data_temp$TransfersInRound)
colnames(trans_in_round_17)[i+1] <- paste0("round_",i)
}
#Transfers out
trans_out_round_17 <- data.frame(index = 1:625)
for( i in 1:28){
year     <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,TransfersOutRound) %>% arrange(index)
trans_out_round_17 <- cbind(trans_out_round_17,data_temp$TransfersOutRound)
colnames(trans_out_round_17)[i+1] <- paste0("round_",i)
}
######################
# Distribute points from k matches
######################
k <- 3
matches <- 27
upper_lim <- matches-(k-1)
#points
for (i in seq(from = 2,by = k, to = upper_lim)) {
points_round_temp <- data.frame(index = 1:625)
points_round_temp[,2:(k+1)] <- points_round_17[,i:(i+(k-1))]
colnames(points_round_temp)[2:(k)] <- paste0("prev_",(k-1):1)
colnames(points_round_temp)[(k+1)] <- "realized"
if(i == 2){
points_round_k_17 <- points_round_temp
} else{
points_round_k_17    <- rbind(points_round_k_17,points_round_temp)
}
}
#Opponents
for (i in seq(from = 2,by = k, to = upper_lim)) {
opponent_round_temp <- data.frame(index = 1:625)
opponent_round_temp[,2] <- opponent_round_17[,(i+(k-1))]
colnames(opponent_round_temp)[2] <- "opponent"
if(i == 2){
opponent_round_k_17 <- opponent_round_temp
} else{
opponent_round_k_17    <- rbind(opponent_round_k_17,opponent_round_temp)
}
}
opponent_round_k_17 <- opponent_round_k_17 %>% select(opponent)
#Team
for (i in seq(from = 2,by = k, to = upper_lim)) {
team_round_temp <- data.frame(index = 1:625)
team_round_temp[,2] <- team_round_17[,(i)]
colnames(team_round_temp)[2] <- "team"
if(i == 2){
team_round_k_17 <- team_round_temp
} else{
team_round_k_17    <- rbind(team_round_k_17,team_round_temp)
}
}
team_round_k_17 <- team_round_k_17 %>% select(team)
#Cost
for (i in seq(from = 2,by = k, to = upper_lim)) {
cost_round_temp <- data.frame(index = 1:625)
cost_round_temp[,2] <- cost_round_17[,(i)]
colnames(cost_round_temp)[2] <- "cost"
if(i == 2){
cost_round_k_17 <- cost_round_temp
} else{
cost_round_k_17    <- rbind(cost_round_k_17,cost_round_temp)
}
}
cost_round_k_17 <- cost_round_k_17 %>% select(cost)
#Pos
for (i in seq(from = 2,by = k, to = upper_lim)) {
pos_round_temp <- data.frame(index = 1:625)
pos_round_temp[,2] <- pos_round_17[,(i)]
colnames(pos_round_temp)[2] <- "pos"
if(i == 2){
pos_round_k_17 <- pos_round_temp
} else{
pos_round_k_17    <- rbind(pos_round_k_17,pos_round_temp)
}
}
pos_round_k_17 <- pos_round_k_17 %>% select(pos)
#Transfers in
for (i in seq(from = 2,by = k, to = upper_lim)) {
trans_in_round_temp <- data.frame(index = 1:625)
trans_in_round_temp[,2:(k+1)] <- trans_in_round_17[,i:(i+(k-1))]
colnames(trans_in_round_temp)[2:(k)] <- paste0("trans_in_prev_",(k-1):1)
colnames(trans_in_round_temp)[(k+1)] <- "realized"
if(i == 2){
trans_in_round_k_17 <- trans_in_round_temp
} else{
trans_in_round_k_17    <- rbind(trans_in_round_k_17,trans_in_round_temp)
}
}
trans_in_round_k_17 <- trans_in_round_k_17 %>% select(trans_in_prev_2,trans_in_prev_1)
#Transfers out
for (i in seq(from = 2,by = k, to = upper_lim)) {
trans_out_round_temp <- data.frame(index = 1:625)
trans_out_round_temp[,2:(k+1)] <- trans_out_round_17[,i:(i+(k-1))]
colnames(trans_out_round_temp)[2:(k)] <- paste0("trans_out_prev_",(k-1):1)
colnames(trans_out_round_temp)[(k+1)] <- "realized"
if(i == 2){
trans_out_round_k_17 <- trans_out_round_temp
} else{
trans_out_round_k_17 <- rbind(trans_out_round_k_17,trans_out_round_temp)
}
}
trans_out_round_k_17 <- trans_out_round_k_17 %>% select(trans_out_prev_2,trans_out_prev_1)
regressors_17 <- cbind(points_round_k_17,opponent_round_k_17,team_round_k_17,
pos_round_k_17,trans_in_round_k_17,trans_out_round_k_17)
regressors_17$index <- as.factor(regressors_17$index)
regressors_17 <- cbind(points_round_k_17,opponent_round_k_17,team_round_k_17,
pos_round_k_17,trans_in_round_k_17,trans_out_round_k_17)
regressors_17$index <- as.factor(regressors_17$index)
predictors  <- regressors_17[1:625,] %>% na.omit()
predictors  <- predictors %>% filter(index %in% regressors_train_16$index) %>% filter(
!opponent %in% c("Brighton", "Huddersfield", "Newcastle")) %>% filter(
!team %in% c("BHA", "HUD", "NEW")
)
realizations <- predictors$realized
predictors  <- predictors[,names(predictors) != "realized"]
predictions <- predict(object = model_3,newdata = predictors)
compare <- data.frame(pred = round(predictions), real = realizations )
View(compare)
compare <- data.frame(pred = predictions, real = realizations )
View(compare)
View(predictors)
View(regressors_17)
View(trans_in_round_17)
View(compare)
predictors  <- regressors_17[1251:1876,] %>% na.omit()
View(predictors)
predictors  <- regressors_17[1251:1875,] %>% na.omit()
predictors  <- predictors %>% filter(index %in% regressors_train_16$index) %>% filter(
!opponent %in% c("Brighton", "Huddersfield", "Newcastle")) %>% filter(
!team %in% c("BHA", "HUD", "NEW")
)
realizations <- predictors$realized
regressors_16 <- cbind(points_round_k_16,opponent_round_k_16,team_round_k_16,cost_round_k_16,
pos_round_k_16,trans_in_round_k_16,trans_out_round_k_16)
regressors_16$index <- as.factor(regressors_16$index)
#Needs generalization
regressors_train_16 <- regressors_16[1:6250,] %>% na.omit()
regressors_test_data_16  <- regressors_16[6251:6875,] %>% na.omit()
regressors_test_data_16  <- regressors_test_data_16 %>% filter(index %in% regressors_train_16$index)
regressors_test_16  <- regressors_test_data_16[,names(regressors_test_data_16) != "realized"]
View(regressors_16)
options(stringsAsFactors = T)
model_3 <- lm(realized ~ index + prev_2 + prev_1 + opponent + team + cost + pos + trans_in_prev_2 +
trans_in_prev_2 + trans_out_prev_1 + trans_out_prev_2,
data = regressors_train_16)
summary(model_3)
predictions <- predict(object = model_3,newdata = regressors_test_16)
compare <- data.frame(pred = predictions, real = regressors_test_data_16$realized )
View(compare)
regressors_17 <- cbind(points_round_k_17,opponent_round_k_17,team_round_k_17,
cost_round_k_17, pos_round_k_17,trans_in_round_k_17,trans_out_round_k_17)
regressors_17$index <- as.factor(regressors_17$index)
predictors  <- regressors_17[1:625,] %>% na.omit()
predictors  <- predictors %>% filter(index %in% regressors_train_16$index) %>% filter(
!opponent %in% c("Brighton", "Huddersfield", "Newcastle")) %>% filter(
!team %in% c("BHA", "HUD", "NEW")
)
realizations <- predictors$realized
predictors  <- predictors[,names(predictors) != "realized"]
predictions <- predict(object = model_3,newdata = predictors)
compare <- data.frame(pred = predictions, real = realizations )
View(compare)
