Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_temp_0 <- full_join(players_temp_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_0 <- players_temp_0 %>% select(index,NextFixture1)
players_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_temp_1 <- full_join(players_temp_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_1 <- full_join(players_temp_1,players_temp_0,by = "index")
players_temp_1 <- players_temp_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
name <- paste0("regressors_",i+1)
assign(name,players_temp_1)
}
View(regressors_1)
for( i in 0:8){
year     <- "17"
week_0   <- as.character(i)
week_1   <- as.character(i+1)
sheet_0  <- paste0("FPL",year,"-GW",week_0,".csv")
sheet_1  <- paste0("FPL",year,"-GW",week_1,".csv")
path_0   <- paste0(folder,sheet_0)
path_1   <- paste0(folder,sheet_1)
data_temp_0   <- read.csv(path_0)
data_temp_1   <- read.csv(path_1)
data_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_temp_0 <- full_join(players_temp_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_0 <- players_temp_0 %>% select(index,NextFixture1)
players_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_temp_1 <- full_join(players_temp_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_1 <- full_join(players_temp_1,players_temp_0,by = "index")
players_temp_1 <- players_temp_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
name <- paste0("regressors_",i+1)
assign(name,players_temp_1)
}
for( i in 0:8){
year   <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
name   <- paste0("data_",week)
data   <- read.csv(path)
data <- data %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
assign(name,data)
}
regressors <- regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points
)
regressors <- full_join(regressors_3,regressors_1)
rm(list = ls())
folder <- "input/"
year   <- "17"
week   <- "26"
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_26 <- read.csv(path)
players <- data_26 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players <- players %>% arrange(match(PositionsList, c("GLK","DEF","MID","FWD")),Team) %>% mutate(
index = 1:625
) %>% select(FirstName_1,Surname_1,PositionsList,Team,index)
for( i in 0:8){
year     <- "17"
week_0   <- as.character(i)
week_1   <- as.character(i+1)
sheet_0  <- paste0("FPL",year,"-GW",week_0,".csv")
sheet_1  <- paste0("FPL",year,"-GW",week_1,".csv")
path_0   <- paste0(folder,sheet_0)
path_1   <- paste0(folder,sheet_1)
data_temp_0   <- read.csv(path_0)
data_temp_1   <- read.csv(path_1)
data_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_temp_0 <- full_join(players_temp_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_0 <- players_temp_0 %>% select(index,NextFixture1)
players_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_temp_1 <- full_join(players_temp_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_1 <- full_join(players_temp_1,players_temp_0,by = "index")
players_temp_1 <- players_temp_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(index,Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent) %>% na.omit()
name <- paste0("regressors_",i+1)
assign(name,players_temp_1)
}
View(regressors_1)
regressors <- full_join(regressors_3,regressors_1,by = "index")
regressors <- full_join(regressors_3,regressors_1,by = "index") %>% na.omit()
View(regressors)
regressors <- full_join(regressors_3,regressors_1,by = c("index","Team", "PositionsList")) %>% na.omit()
View(regressors)
regressors_3 <- regressors_3 %>% filter(index %in% regressors_1$index)
rm(list = ls())
folder <- "input/"
year   <- "17"
week   <- "26"
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_26 <- read.csv(path)
players <- data_26 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players <- players %>% arrange(match(PositionsList, c("GLK","DEF","MID","FWD")),Team) %>% mutate(
index = 1:625
) %>% select(FirstName_1,Surname_1,PositionsList,Team,index)
folder <- "input/"
for( i in 0:8){
year     <- "17"
week_0   <- as.character(i)
week_1   <- as.character(i+1)
sheet_0  <- paste0("FPL",year,"-GW",week_0,".csv")
sheet_1  <- paste0("FPL",year,"-GW",week_1,".csv")
path_0   <- paste0(folder,sheet_0)
path_1   <- paste0(folder,sheet_1)
data_temp_0   <- read.csv(path_0)
data_temp_1   <- read.csv(path_1)
data_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_temp_0 <- full_join(players_temp_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_0 <- players_temp_0 %>% select(index,NextFixture1)
players_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_temp_1 <- full_join(players_temp_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_1 <- full_join(players_temp_1,players_temp_0,by = "index")
players_temp_1 <- players_temp_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(index,Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent
) %>% arrange(index) %>% na.omit()
name <- paste0("regressors_",i+1)
assign(name,players_temp_1)
}
View(regressors_1)
View(regressors_9)
regressors_3 <- regressors_3 %>% filter(index %in% regressors_1$index)
regressors_2 <- regressors_2 %>% filter(index %in% regressors_1$index)
regressors <- full_join(regressors_3,regressors_1,by = c("index","Team", "PositionsList"))
View(regressors)
regressors_3 <- regressors_3 %>% filter(index %in% regressors_1$index)
regressors_2 <- regressors_2 %>% filter(index %in% regressors_1$index)
regressors <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points
)
View(regressors_3)
View(regressors)
View(regressors_1)
View(regressors_2)
regressors_4 <- regressors_4 %>% filter(index %in% regressors_1$index)
regressors <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match)
regressors <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match)
View(regressors)
regressors <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real)
View(regressors_4)
View(regressors_1)
############
#Data wash
############
regressors_1 <- regressors_2 %>% filter(index %in% regressors_1$index)
############
#Data wash
############
regressors_1 <- regressors_2 %>% filter(index %in% regressors_1$index)
regressors_2 <- regressors_2 %>% filter(index %in% regressors_1$index)
regressors_3 <- regressors_3 %>% filter(index %in% regressors_1$index)
regressors_4 <- regressors_4 %>% filter(index %in% regressors_1$index)
regressors <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real)
View(regressors_1)
regressors <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real)
options(stringsAsFactors = T)
model_3 <- lm(points_realized ~ ., data = regressors)
model_3 <- lm(points_real ~ ., data = regressors)
summary(model_3)
############
#Data wash
############
regressors_1 <- regressors_1 %>% filter(index %in% regressors_1$index)
############
#Data wash
############
regressors_1 <- regressors_1 %>% filter(index %in% regressors_1$index)
regressors_2 <- regressors_2 %>% filter(index %in% regressors_1$index)
regressors_3 <- regressors_3 %>% filter(index %in% regressors_1$index)
regressors_4 <- regressors_4 %>% filter(index %in% regressors_1$index)
regressors <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real)
options(stringsAsFactors = T)
model_3 <- lm(points_real ~ ., data = regressors)
summary(model_3)
rm(list = ls())
folder <- "input/"
year   <- "17"
week   <- "26"
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_26 <- read.csv(path)
players <- data_26 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players <- players %>% arrange(match(PositionsList, c("GLK","DEF","MID","FWD")),Team) %>% mutate(
index = 1:625
) %>% select(FirstName_1,Surname_1,PositionsList,Team,index)
options(stringsAsFactors = F)
folder <- "input/"
year   <- "17"
week   <- "26"
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_26 <- read.csv(path)
players <- data_26 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players <- players %>% arrange(match(PositionsList, c("GLK","DEF","MID","FWD")),Team) %>% mutate(
index = 1:625
) %>% select(FirstName_1,Surname_1,PositionsList,Team,index)
#####################################
# Fit model based on training set: 16/17 season
# Build regression model on all categorical varaibles except individual player
# Individual player regression might be considered. Also worth discussing in thesis
# Must define set of players to make sure the same player is represented each round:
# choose first week after deadline day
#####################################
#Import training data
folder <- "input/"
year   <- "17"
week   <- "0"
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_0 <- read.csv(path)
for( i in 0:12){
year   <- "17"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
name   <- paste0("data_",week)
data   <- read.csv(path)
data <- data %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
assign(name,data)
}
for( i in 0:12){
year     <- "17"
week_0   <- as.character(i)
week_1   <- as.character(i+1)
sheet_0  <- paste0("FPL",year,"-GW",week_0,".csv")
sheet_1  <- paste0("FPL",year,"-GW",week_1,".csv")
path_0   <- paste0(folder,sheet_0)
path_1   <- paste0(folder,sheet_1)
data_temp_0   <- read.csv(path_0)
data_temp_1   <- read.csv(path_1)
data_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players_temp_0 <- data_temp_0 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,NextFixture1)
players_temp_0 <- full_join(players_temp_0,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_0 <- players_temp_0 %>% select(index,NextFixture1)
players_temp_1 <- data_temp_1 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
) %>% select(FirstName_1,Surname_1,Cost,PointsLastRound,TransfersOutRound,TransfersInRound)
players_temp_1 <- full_join(players_temp_1,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
players_temp_1 <- full_join(players_temp_1,players_temp_0,by = "index")
players_temp_1 <- players_temp_1 %>% mutate(
opponent = NextFixture1,
points   = PointsLastRound
) %>% select(index,Team,PositionsList,Cost,points,TransfersInRound,TransfersOutRound,opponent
) %>% arrange(index) %>% na.omit()
name <- paste0("regressors_",i+1)
assign(name,players_temp_1)
}
regressors_tot_1 <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points,
average     = mean(points_1,points_2,points_3)
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real,average)
############
#Data wash
############
# Regressors 1
#############
regressors_1 <- regressors_1 %>% filter(index %in% regressors_1$index)
regressors_2 <- regressors_2 %>% filter(index %in% regressors_1$index)
regressors_3 <- regressors_3 %>% filter(index %in% regressors_1$index)
regressors_4 <- regressors_4 %>% filter(index %in% regressors_1$index)
regressors_tot_1 <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points,
average     = mean(points_1,points_2,points_3)
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real,average)
############
#Data wash
############
# Regressors 1
#############
regressors_1 <- regressors_1 %>% filter(index %in% regressors_1$index)
regressors_2 <- regressors_2 %>% filter(index %in% regressors_1$index)
regressors_3 <- regressors_3 %>% filter(index %in% regressors_1$index)
regressors_4 <- regressors_4 %>% filter(index %in% regressors_1$index)
regressors_tot_1 <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real)
# Regressors 2
#############
regressors_5 <- regressors_5 %>% filter(index %in% regressors_1$index)
regressors_6 <- regressors_6 %>% filter(index %in% regressors_1$index)
regressors_7 <- regressors_7 %>% filter(index %in% regressors_1$index)
regressors_8 <- regressors_8 %>% filter(index %in% regressors_1$index)
regressors_tot_2 <-  regressors_7 %>% mutate(
points_3 = regressors_5$points,
points_2 = regressors_6$points,
points_1 = points,
next_match = regressors_8$opponent,
points_real = regressors_8$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real)
# Predict
#############
predictors_9  <- regressors_9 %>% filter(index %in% regressors_1$index)
predictors_10 <- regressors_10 %>% filter(index %in% regressors_1$index)
predictors_11 <- regressors_11 %>% filter(index %in% regressors_1$index)
predictors_12 <- regressors_12 %>% filter(index %in% regressors_1$index)
# Predict
#############
regressors_9  <- regressors_9 %>% filter(index %in% regressors_1$index)
regressors_10 <- regressors_10 %>% filter(index %in% regressors_1$index)
regressors_11 <- regressors_11 %>% filter(index %in% regressors_1$index)
regressors_12 <- regressors_12 %>% filter(index %in% regressors_1$index)
predictors <-  regressors_11 %>% mutate(
points_3 = regressors_9$points,
points_2 = regressors_10$points,
points_1 = points,
next_match = regressors_11$opponent
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match)
View(predictors)
regressors_tot <- rbind(regressors_tot_1,regressors_tot_2)
View(regressors_tot)
##########################
# Regression
##########################
options(stringsAsFactors = T)
model_3 <- lm(points_real ~ ., data = regressors_tot)
summary(model_3)
predictions <- predict(object = model_3,newdata = predictors)
regressors_1 <- regressors_1 %>% filter(index %in% regressors_1$index)
regressors_2 <- regressors_2 %>% filter(index %in% regressors_1$index)
regressors_3 <- regressors_3 %>% filter(index %in% regressors_1$index)
regressors_4 <- regressors_4 %>% filter(index %in% regressors_1$index)
regressors_tot_1 <-  regressors_3 %>% mutate(
points_3 = regressors_1$points,
points_2 = regressors_2$points,
points_1 = points,
next_match = regressors_4$opponent,
points_real = regressors_4$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real)
# Regressors 2
#############
regressors_5 <- regressors_5 %>% filter(index %in% regressors_1$index)
regressors_6 <- regressors_6 %>% filter(index %in% regressors_1$index)
regressors_7 <- regressors_7 %>% filter(index %in% regressors_1$index)
regressors_8 <- regressors_8 %>% filter(index %in% regressors_1$index)
regressors_tot_2 <-  regressors_7 %>% mutate(
points_3 = regressors_5$points,
points_2 = regressors_6$points,
points_1 = points,
next_match = regressors_8$opponent,
points_real = regressors_8$points
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match,points_real)
# Predict
#############
regressors_9  <- regressors_9 %>% filter(index %in% regressors_1$index)
regressors_10 <- regressors_10 %>% filter(index %in% regressors_1$index)
regressors_11 <- regressors_11 %>% filter(index %in% regressors_1$index)
regressors_12 <- regressors_12 %>% filter(index %in% regressors_1$index)
predictors <-  regressors_11 %>% mutate(
points_3 = regressors_9$points,
points_2 = regressors_10$points,
points_1 = points,
next_match = regressors_12$opponent
) %>% select(Team,PositionsList,Cost,TransfersInRound,TransfersOutRound,points_3,points_2,points_1,next_match)
regressors_tot <- rbind(regressors_tot_1,regressors_tot_2)
##########################
# Regression
##########################
options(stringsAsFactors = T)
model_3 <- lm(points_real ~ ., data = regressors_tot)
summary(model_3)
predictions <- predict(object = model_3,newdata = predictors)
compare <- data.frame(predictions = round(predictions), real = regressors_12$points)
View(compare)
View(regressors_2)
View(regressors_tot)
View(regressors_tot_1)
View(predictors)
