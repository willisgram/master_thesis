regressors_test_data_16_k_u  <- regressors_16_u[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_test_data_16_k_u %>% filter(index %in% regressors_train_16_k_u$index)
regressors_test_16_k_u  <- regressors_test_data_16_k_u[,names(regressors_test_data_16_k) != "realized"]
##New predictions
predictions_u <- predict(object = model_3,newdata = regressors_test_16_k_u)
##Store
##Store
name <- paste0("gw",as.character(week))
predictions_table <- cbind(predictions_table,predictions_u)
colnames(predictions_table)[j+1] <- name
}
}
View(predictions_table)
for (j in 1:5) {
if(j == 1){
#Create regressors
regressors_train_16_k <- regressors_16[1:m,] %>% na.omit()
regressors_test_data_16_k  <- regressors_16[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k  <- regressors_test_data_16_k %>% filter(index %in% regressors_train_16_k$index)
regressors_test_16_k  <- regressors_test_data_16_k[,names(regressors_test_data_16_k) != "realized"]
##Fit model
model_3 <- lm(realized ~ index + prev_2 + prev_1 + opponent + team + cost + pos + trans_in_prev_2 +
trans_in_prev_2 + trans_out_prev_1 + trans_out_prev_2,
data = regressors_train_16_k)
##Predict
predictions <- predict(object = model_3,newdata = regressors_test_16_k)
##Store
name <- paste0("gw",as.character(week))
predictions_table <- regressors_test_data_16_k %>% mutate(
index_int = as.integer(index)
) %>% select(index_int)
predictions_table <- cbind(predictions_table,predictions)
colnames(predictions_table)[j+1] <- name
} else{
# u for update:
observations_u <- observations - j*625
opponent_round_k_16_u <- opponent_round_k_16 %>% tail(observations_u)
team_round_k_16_u <- team_round_k_16 %>% tail(observations_u)
# Static
points_round_k_16_u <- points_round_k_16 %>% head(observations_u)
cost_round_k_16_u <- cost_round_k_16 %>% head(observations_u)
pos_round_k_16_u <- pos_round_k_16 %>% head(observations_u)
trans_in_round_k_16_u <- trans_in_round_k_16 %>% head(observations_u)
trans_out_round_k_16_u <- trans_out_round_k_16 %>% head(observations_u)
regressors_16_u <- cbind(points_round_k_16_u,opponent_round_k_16_u,team_round_k_16_u,cost_round_k_16_u,
pos_round_k_16_u,trans_in_round_k_16_u,trans_out_round_k_16_u)
regressors_16_u$index <- as.factor(regressors_16_u$index)
regressors_train_16_k_u <- regressors_16_u[1:m,] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_16_u[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_test_data_16_k_u %>% filter(index %in% regressors_train_16_k_u$index)
regressors_test_16_k_u  <- regressors_test_data_16_k_u[,names(regressors_test_data_16_k) != "realized"]
##New predictions
predictions_u <- predict(object = model_3,newdata = regressors_test_16_k_u)
##Store
##Store
name <- paste0("gw",as.character(week+j))
predictions_table <- cbind(predictions_table,predictions_u)
colnames(predictions_table)[j+1] <- name
}
}
for (j in 1:5) {
if(j == 1){
#Create regressors
regressors_train_16_k <- regressors_16[1:m,] %>% na.omit()
regressors_test_data_16_k  <- regressors_16[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k  <- regressors_test_data_16_k %>% filter(index %in% regressors_train_16_k$index)
regressors_test_16_k  <- regressors_test_data_16_k[,names(regressors_test_data_16_k) != "realized"]
##Fit model
model_3 <- lm(realized ~ index + prev_2 + prev_1 + opponent + team + cost + pos + trans_in_prev_2 +
trans_in_prev_2 + trans_out_prev_1 + trans_out_prev_2,
data = regressors_train_16_k)
##Predict
predictions <- predict(object = model_3,newdata = regressors_test_16_k)
##Store
name <- paste0("gw",as.character(week))
predictions_table <- regressors_test_data_16_k %>% mutate(
index_int = as.integer(index)
) %>% select(index_int)
predictions_table <- cbind(predictions_table,predictions)
colnames(predictions_table)[j+1] <- name
} else{
# u for update:
observations_u <- observations - j*625
opponent_round_k_16_u <- opponent_round_k_16 %>% tail(observations_u)
team_round_k_16_u <- team_round_k_16 %>% tail(observations_u)
# Static
points_round_k_16_u <- points_round_k_16 %>% head(observations_u)
cost_round_k_16_u <- cost_round_k_16 %>% head(observations_u)
pos_round_k_16_u <- pos_round_k_16 %>% head(observations_u)
trans_in_round_k_16_u <- trans_in_round_k_16 %>% head(observations_u)
trans_out_round_k_16_u <- trans_out_round_k_16 %>% head(observations_u)
regressors_16_u <- cbind(points_round_k_16_u,opponent_round_k_16_u,team_round_k_16_u,cost_round_k_16_u,
pos_round_k_16_u,trans_in_round_k_16_u,trans_out_round_k_16_u)
regressors_16_u$index <- as.factor(regressors_16_u$index)
regressors_train_16_k_u <- regressors_16_u[1:m,] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_16_u[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_test_data_16_k_u %>% filter(index %in% regressors_train_16_k_u$index)
regressors_test_16_k_u  <- regressors_test_data_16_k_u[,names(regressors_test_data_16_k) != "realized"]
##New predictions
predictions_u <- predict(object = model_3,newdata = regressors_test_16_k_u)
##Store
##Store
name <- paste0("gw",as.character(week+j-1))
predictions_table <- cbind(predictions_table,predictions_u)
colnames(predictions_table)[j+1] <- name
}
}
observations <- dim(points_round_k_16)[1]
for(week in 6:10){
# index-keepers
n <- floor(week/k)
z <- week%%k
start <- 625*z +1
m     <- (n*k-(1-z))*625
#Forecasts begins in week 6
for (j in 1:5) {
if(j == 1){
#Create regressors
regressors_train_16_k <- regressors_16[1:m,] %>% na.omit()
regressors_test_data_16_k  <- regressors_16[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k  <- regressors_test_data_16_k %>% filter(index %in% regressors_train_16_k$index)
regressors_test_16_k  <- regressors_test_data_16_k[,names(regressors_test_data_16_k) != "realized"]
##Fit model
model_3 <- lm(realized ~ index + prev_2 + prev_1 + opponent + team + cost + pos + trans_in_prev_2 +
trans_in_prev_2 + trans_out_prev_1 + trans_out_prev_2,
data = regressors_train_16_k)
##Predict
predictions <- predict(object = model_3,newdata = regressors_test_16_k)
##Store
name <- paste0("gw",as.character(week))
predictions_table <- regressors_test_data_16_k %>% mutate(
index_int = as.integer(index)
) %>% select(index_int)
predictions_table <- cbind(predictions_table,predictions)
colnames(predictions_table)[j+1] <- name
} else{
# u for update:
observations_u <- observations - j*625
opponent_round_k_16_u <- opponent_round_k_16 %>% tail(observations_u)
team_round_k_16_u <- team_round_k_16 %>% tail(observations_u)
# Static
points_round_k_16_u <- points_round_k_16 %>% head(observations_u)
cost_round_k_16_u <- cost_round_k_16 %>% head(observations_u)
pos_round_k_16_u <- pos_round_k_16 %>% head(observations_u)
trans_in_round_k_16_u <- trans_in_round_k_16 %>% head(observations_u)
trans_out_round_k_16_u <- trans_out_round_k_16 %>% head(observations_u)
regressors_16_u <- cbind(points_round_k_16_u,opponent_round_k_16_u,team_round_k_16_u,cost_round_k_16_u,
pos_round_k_16_u,trans_in_round_k_16_u,trans_out_round_k_16_u)
regressors_16_u$index <- as.factor(regressors_16_u$index)
regressors_train_16_k_u <- regressors_16_u[1:m,] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_16_u[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_test_data_16_k_u %>% filter(index %in% regressors_train_16_k_u$index)
regressors_test_16_k_u  <- regressors_test_data_16_k_u[,names(regressors_test_data_16_k) != "realized"]
##New predictions
predictions_u <- predict(object = model_3,newdata = regressors_test_16_k_u)
##Store
##Store
name <- paste0("gw",as.character(week+j-1))
predictions_table <- cbind(predictions_table,predictions_u)
colnames(predictions_table)[j+1] <- name
}
}
name <- paste0("forecasts_week_", as.character(week))
assign(x = name,value = predictions_table)
}
View(forecasts_week_6)
rm(list = ls())
library(tidyverse)
options(stringsAsFactors = F)
#List after transfer window. Assume it to be enough
folder <- "input/"
year   <- "17"
week   <- "26"
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_26 <- read.csv(path)
players <- data_26 %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
players <- players %>% arrange(match(PositionsList, c("GLK","DEF","MID","FWD")),Team) %>% mutate(
index = 1:625
) %>% select(FirstName_1,Surname_1,PositionsList,Team,index)
######################
# Full 2016 data import
######################
#Points
###########
#Import training data
library(tidyverse)
options(stringsAsFactors = F)
folder <- "input/"
points_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,PointsLastRound) %>% arrange(index)
points_round_16 <- cbind(points_round_16,data_temp$PointsLastRound)
colnames(points_round_16)[i-3] <- paste0("round_",i)
}
#Opponents
opponent_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,NextFixture1) %>% arrange(index)
opponent_round_16 <- cbind(opponent_round_16,data_temp$NextFixture1)
colnames(opponent_round_16)[i-3] <- paste0("round_",i+1)
}
#Cost
cost_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,Cost) %>% arrange(index)
cost_round_16 <- cbind(cost_round_16,data_temp$Cost)
colnames(cost_round_16)[i-3] <- paste0("round_",i)
}
#Team
team_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,Team.x) %>% arrange(index)
team_round_16 <- cbind(team_round_16,data_temp$Team.x)
colnames(team_round_16)[i-3] <- paste0("round_",i)
}
#Position
pos_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,PositionsList.x) %>% arrange(index)
pos_round_16 <- cbind(pos_round_16,data_temp$PositionsList.x)
colnames(pos_round_16)[i-3] <- paste0("round_",i)
}
#Transfers in
trans_in_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,TransfersInRound) %>% arrange(index)
trans_in_round_16 <- cbind(trans_in_round_16,data_temp$TransfersInRound)
colnames(trans_in_round_16)[i-3] <- paste0("round_",i)
}
#Transfers out
trans_out_round_16 <- data.frame(index = 1:625)
for( i in 5:37){
year     <- "16"
week   <- as.character(i)
sheet  <- paste0("FPL",year,"-GW",week,".csv")
path   <- paste0(folder,sheet)
data_temp   <- read.csv(path)
data_temp <- data_temp %>% mutate(
Surname_1   = if_else(grepl(Surname,pattern = " "),sub('.* ', '', Surname),Surname),
FirstName_1 = if_else(grepl(Surname,pattern = " "),sub(' .*', '',Surname ), FirstName)
)
data_temp <- full_join(data_temp,players,by = c("FirstName_1" = "FirstName_1","Surname_1"="Surname_1"))
data_temp <- data_temp[!is.na(data_temp$index),]
data_temp <- data_temp %>% select(index,TransfersOutRound) %>% arrange(index)
trans_out_round_16 <- cbind(trans_out_round_16,data_temp$TransfersOutRound)
colnames(trans_out_round_16)[i-3] <- paste0("round_",i)
}
rm(list = c("data_26","data_temp"))
######################
# Distribute points from k matches
######################
k <- 3
upper_lim <- 34-(k-1)
#points
for (i in seq(from = 2,by = k, to = upper_lim)) {
points_round_temp <- data.frame(index = 1:625)
points_round_temp[,2:(k+1)] <- points_round_16[,i:(i+(k-1))]
colnames(points_round_temp)[2:(k)] <- paste0("prev_",(k-1):1)
colnames(points_round_temp)[(k+1)] <- "realized"
if(i == 2){
points_round_k_16 <- points_round_temp
} else{
points_round_k_16 <- rbind(points_round_k_16,points_round_temp)
}
}
#Opponents
for (i in seq(from = 2,by = k, to = upper_lim)) {
opponent_round_temp <- data.frame(index = 1:625)
opponent_round_temp[,2] <- opponent_round_16[,(i)]
colnames(opponent_round_temp)[2] <- "opponent"
if(i == 2){
opponent_round_k_16 <- opponent_round_temp
} else{
opponent_round_k_16    <- rbind(opponent_round_k_16,opponent_round_temp)
}
}
opponent_round_k_16 <- opponent_round_k_16 %>% select(opponent)
#Team
for (i in seq(from = 2,by = k, to = upper_lim)) {
team_round_temp <- data.frame(index = 1:625)
team_round_temp[,2] <- team_round_16[,(i)]
colnames(team_round_temp)[2] <- "team"
if(i == 2){
team_round_k_16 <- team_round_temp
} else{
team_round_k_16    <- rbind(team_round_k_16,team_round_temp)
}
}
team_round_k_16 <- team_round_k_16 %>% select(team)
#Cost
for (i in seq(from = 2,by = k, to = upper_lim)) {
cost_round_temp <- data.frame(index = 1:625)
cost_round_temp[,2] <- cost_round_16[,(i)]
colnames(cost_round_temp)[2] <- "cost"
if(i == 2){
cost_round_k_16 <- cost_round_temp
} else{
cost_round_k_16    <- rbind(cost_round_k_16,cost_round_temp)
}
}
cost_round_k_16 <- cost_round_k_16 %>% select(cost)
#Pos
for (i in seq(from = 2,by = k, to = upper_lim)) {
pos_round_temp <- data.frame(index = 1:625)
pos_round_temp[,2] <- pos_round_16[,(i)]
colnames(pos_round_temp)[2] <- "pos"
if(i == 2){
pos_round_k_16 <- pos_round_temp
} else{
pos_round_k_16    <- rbind(pos_round_k_16,pos_round_temp)
}
}
pos_round_k_16 <- pos_round_k_16 %>% select(pos)
#Transfers in
for (i in seq(from = 2,by = k, to = upper_lim)) {
trans_in_round_temp <- data.frame(index = 1:625)
trans_in_round_temp[,2:(k+1)] <- trans_in_round_16[,i:(i+(k-1))]
colnames(trans_in_round_temp)[2:(k)] <- paste0("trans_in_prev_",(k-1):1)
colnames(trans_in_round_temp)[(k+1)] <- "realized"
if(i == 2){
trans_in_round_k_16 <- trans_in_round_temp
} else{
trans_in_round_k_16    <- rbind(trans_in_round_k_16,trans_in_round_temp)
}
}
trans_in_round_k_16 <- trans_in_round_k_16 %>% select(trans_in_prev_2,trans_in_prev_1)
#Transfers out
for (i in seq(from = 2,by = k, to = upper_lim)) {
trans_out_round_temp <- data.frame(index = 1:625)
trans_out_round_temp[,2:(k+1)] <- trans_out_round_16[,i:(i+(k-1))]
colnames(trans_out_round_temp)[2:(k)] <- paste0("trans_out_prev_",(k-1):1)
colnames(trans_out_round_temp)[(k+1)] <- "realized"
if(i == 2){
trans_out_round_k_16 <- trans_out_round_temp
} else{
trans_out_round_k_16    <- rbind(trans_out_round_k_16,trans_out_round_temp)
}
}
trans_out_round_k_16 <- trans_out_round_k_16 %>% select(trans_out_prev_2,trans_out_prev_1)
regressors_16 <- cbind(points_round_k_16,opponent_round_k_16,team_round_k_16,cost_round_k_16,
pos_round_k_16,trans_in_round_k_16,trans_out_round_k_16)
regressors_16$index <- as.factor(regressors_16$index)
options(stringsAsFactors = T)
#given input
k <- 3
observations <- dim(points_round_k_16)[1]
week <- 6
# index-keepers
n <- floor(week/k)
z <- week%%k
start <- 625*z +1
m     <- (n*k-(1-z))*625
for (j in 1:5) {
if(j == 1){
#Create regressors
regressors_train_16_k <- regressors_16[1:m,] %>% na.omit()
regressors_test_data_16_k  <- regressors_16[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k  <- regressors_test_data_16_k %>% filter(index %in% regressors_train_16_k$index)
regressors_test_16_k  <- regressors_test_data_16_k[,names(regressors_test_data_16_k) != "realized"]
##Fit model
model_3 <- lm(realized ~ index + prev_2 + prev_1 + opponent + team + cost + pos + trans_in_prev_2 +
trans_in_prev_2 + trans_out_prev_1 + trans_out_prev_2,
data = regressors_train_16_k)
##Predict
predictions <- predict(object = model_3,newdata = regressors_test_16_k)
##Store
name <- paste0("gw",as.character(week))
predictions_table <- regressors_test_data_16_k %>% mutate(
index_int = as.integer(index)
) %>% select(index_int)
predictions_table <- cbind(predictions_table,predictions)
colnames(predictions_table)[j+1] <- name
} else{
# u for update:
observations_u <- observations - j*625
opponent_round_k_16_u <- opponent_round_k_16 %>% tail(observations_u)
team_round_k_16_u <- team_round_k_16 %>% tail(observations_u)
# Static
points_round_k_16_u <- points_round_k_16 %>% head(observations_u)
cost_round_k_16_u <- cost_round_k_16 %>% head(observations_u)
pos_round_k_16_u <- pos_round_k_16 %>% head(observations_u)
trans_in_round_k_16_u <- trans_in_round_k_16 %>% head(observations_u)
trans_out_round_k_16_u <- trans_out_round_k_16 %>% head(observations_u)
regressors_16_u <- cbind(points_round_k_16_u,opponent_round_k_16_u,team_round_k_16_u,cost_round_k_16_u,
pos_round_k_16_u,trans_in_round_k_16_u,trans_out_round_k_16_u)
regressors_16_u$index <- as.factor(regressors_16_u$index)
regressors_train_16_k_u <- regressors_16_u[1:m,] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_16_u[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k_u  <- regressors_test_data_16_k_u %>% filter(index %in% regressors_train_16_k_u$index)
regressors_test_16_k_u  <- regressors_test_data_16_k_u[,names(regressors_test_data_16_k) != "realized"]
##New predictions
predictions_u <- predict(object = model_3,newdata = regressors_test_16_k_u)
##Store
##Store
name <- paste0("gw",as.character(week+j-1))
predictions_table <- cbind(predictions_table,predictions_u)
colnames(predictions_table)[j+1] <- name
}
}
name <- paste0("forecasts_week_", as.character(week))
assign(x = name,value = predictions_table)
week <- 7
# index-keepers
n <- floor(week/k)
z <- week%%k
start <- 625*z +1
m     <- (n*k-(1-z))*625
j <- 1
#Create regressors
regressors_train_16_k <- regressors_16[1:m,] %>% na.omit()
regressors_test_data_16_k  <- regressors_16[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k  <- regressors_test_data_16_k %>% filter(index %in% regressors_train_16_k$index)
regressors_test_16_k  <- regressors_test_data_16_k[,names(regressors_test_data_16_k) != "realized"]
##Fit model
model_3 <- lm(realized ~ index + prev_2 + prev_1 + opponent + team + cost + pos + trans_in_prev_2 +
trans_in_prev_2 + trans_out_prev_1 + trans_out_prev_2,
data = regressors_train_16_k)
summary(model)
summary(model_3)
View(regressors_test_16_k)
#Create regressors
regressors_train_16_k <- regressors_16[start:m,] %>% na.omit()
regressors_test_data_16_k  <- regressors_16[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k  <- regressors_test_data_16_k %>% filter(index %in% regressors_train_16_k$index)
regressors_test_16_k  <- regressors_test_data_16_k[,names(regressors_test_data_16_k) != "realized"]
regressors_train_16_k <- regressors_16[start:m,] %>% na.omit()
regressors_test_data_16_k  <- regressors_16[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k  <- regressors_test_data_16_k %>% filter(index %in% regressors_train_16_k$index)
regressors_test_16_k  <- regressors_test_data_16_k[,names(regressors_test_data_16_k) != "realized"]
View(regressors_train_16_k)
View(regressors_test_16_k)
View(regressors_test_data_16_k)
week <- 6
# index-keepers
n <- floor(week/k)
z <- week%%k
start <- 625*z +1
m     <- (n*k-(1-z))*625
regressors_train_16_k <- regressors_16[start:m,] %>% na.omit()
regressors_test_data_16_k  <- regressors_16[(m+1):(m+625),] %>% na.omit()
regressors_test_data_16_k  <- regressors_test_data_16_k %>% filter(index %in% regressors_train_16_k$index)
regressors_test_16_k  <- regressors_test_data_16_k[,names(regressors_test_data_16_k) != "realized"]
